<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculateur de débits - Mémo Technique VMC</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .result-box { background: #f8f9fa; border-radius: 8px; padding: 1rem; margin-top: 1rem; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">Mémo Technique VMC</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="simple-flux.html">VMC Simple Flux</a></li>
          <li class="nav-item"><a class="nav-link" href="double-flux.html">VMC Double Flux</a></li>
          <li class="nav-item"><a class="nav-link active" href="#">Calculateur de débits</a></li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="container">
    <h1 class="mb-4">Calculateur de débits réglementaires</h1>
    <form id="calcForm">
      <div class="row mb-3">
        <div class="col-md-6">
          <label for="vmcType" class="form-label">Type de VMC</label>
          <select class="form-select" id="vmcType" required>
            <option value="">Choisir...</option>
            <option value="simple-flux">Simple Flux</option>
            <option value="hygro-a">Hygro A</option>
            <option value="hygro-b">Hygro B</option>
          </select>
        </div>
        <div class="col-md-6">
          <label for="housingType" class="form-label">Type de logement</label>
          <select class="form-select" id="housingType" required>
            <option value="">Choisir...</option>
            <option value="T1">T1</option>
            <option value="T2">T2</option>
            <option value="T3">T3</option>
            <option value="T4">T4</option>
            <option value="T5+">T5+</option>
          </select>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md-3">
          <label for="cuisine" class="form-label">Nombre de cuisines</label>
          <input type="number" class="form-control" id="cuisine" min="0" value="0">
        </div>
        <div class="col-md-3">
          <label for="sdb" class="form-label">Nombre de salles de bain</label>
          <input type="number" class="form-control" id="sdb" min="0" value="0">
        </div>
        <div class="col-md-3">
          <label for="wc" class="form-label">Nombre de WC</label>
          <input type="number" class="form-control" id="wc" min="0" value="0">
        </div>
        <div class="col-md-3">
          <label for="autreSdb" class="form-label">Autres salles d'eau</label>
          <input type="number" class="form-control" id="autreSdb" min="0" value="0">
        </div>
      </div>
      <button type="submit" class="btn btn-primary">Calculer</button>
    </form>
    <div id="results" class="result-box d-none"></div>
    <a href="index.html" class="btn btn-secondary mt-4">Retour à l'accueil</a>
  </div>
  <script>
    const debitsReglementaires = {
      'simple-flux': { 'cuisine': 75, 'salle-de-bain': 50, 'wc': 30, 'autre-sdb': 50 },
      'hygro-a': { 'cuisine': 75, 'salle-de-bain': 50, 'wc': 30, 'autre-sdb': 50 },
      'hygro-b': { 'cuisine': 75, 'salle-de-bain': 50, 'wc': 30, 'autre-sdb': 50 }
    };
    const minimumDebitsParLogement = { 'T1': 100, 'T2': 150, 'T3': 200, 'T4': 250, 'T5+': 300 };
    document.getElementById('calcForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const vmcType = document.getElementById('vmcType').value;
      const housingType = document.getElementById('housingType').value;
      const cuisine = parseInt(document.getElementById('cuisine').value) || 0;
      const sdb = parseInt(document.getElementById('sdb').value) || 0;
      const wc = parseInt(document.getElementById('wc').value) || 0;
      const autreSdb = parseInt(document.getElementById('autreSdb').value) || 0;
      if (!vmcType || !housingType) return;
      const flows = debitsReglementaires[vmcType];
      const results = {
        'Cuisine': cuisine * flows['cuisine'],
        'Salle de bain': sdb * flows['salle-de-bain'],
        'WC': wc * flows['wc'],
        'Autre salle d\'eau': autreSdb * flows['autre-sdb']
      };
      const total = Object.values(results).reduce((a, b) => a + b, 0);
      const minFlow = minimumDebitsParLogement[housingType];
      let html = `<h3>Résultats</h3><ul class='mb-3'>`;
      for (const [piece, val] of Object.entries(results)) {
        html += `<li><strong>${piece}</strong> : ${val} m³/h</li>`;
      }
      html += `</ul><p><strong>Débit total</strong> : ${total} m³/h</p>`;
      html += `<p><strong>Débit minimal réglementaire</strong> : ${minFlow} m³/h</p>`;
      html += `<p class='${total >= minFlow ? 'text-success' : 'text-danger'}'><strong>${total >= minFlow ? 'Conforme' : 'Non conforme'}</strong></p>`;
      const resDiv = document.getElementById('results');
      resDiv.innerHTML = html;
      resDiv.classList.remove('d-none');
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
