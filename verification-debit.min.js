document.addEventListener("DOMContentLoaded",function(){console.log("Chargement du module de vérification des débits...");const e=()=>{window.vmcContent?(console.log("Accès à vmcContent réussi"),function(){window.vmcContent||(console.error("vmcContent non disponible - création d'un objet vide"),window.vmcContent={});const e={"simple-flux":{T1:{cuisine:{min:20,max:75},"salle-de-bain":{min:15,max:15},wc:{min:15,max:15},"autre-sdb":{min:0,max:15}},T2:{cuisine:{min:30,max:90},"salle-de-bain":{min:15,max:15},wc:{min:15,max:15},"autre-sdb":{min:0,max:15}},T3:{cuisine:{min:45,max:105},"salle-de-bain":{min:30,max:30},wc:{min:15,max:15},"autre-sdb":{min:15,max:15}},T4:{cuisine:{min:45,max:120},"salle-de-bain":{min:30,max:30},wc:{min:30,max:30},"autre-sdb":{min:15,max:15}},"T5+":{cuisine:{min:45,max:135},"salle-de-bain":{min:30,max:30},wc:{min:30,max:30},"autre-sdb":{min:15,max:15}}},"hygro-a":{T1:{cuisine:{min:10,max:50},"salle-de-bain":{min:10,max:40},wc:{min:5,max:30},"autre-sdb":{min:0,max:40}},T2:{cuisine:{min:10,max:50},"salle-de-bain":{min:10,max:40},wc:{min:5,max:30},"autre-sdb":{min:0,max:40}},T3:{cuisine:{min:15,max:50},"salle-de-bain":{min:10,max:40},wc:{min:5,max:30},"autre-sdb":{min:10,max:40}},T4:{cuisine:{min:20,max:55},"salle-de-bain":{min:15,max:45},wc:{min:5,max:30},"autre-sdb":{min:15,max:45}},"T5+":{cuisine:{min:25,max:60},"salle-de-bain":{min:15,max:45},wc:{min:10,max:30},"autre-sdb":{min:15,max:45}}},"hygro-b":{T1:{cuisine:{min:10,max:50},"salle-de-bain":{min:5,max:40},wc:{min:5,max:30},"autre-sdb":{min:0,max:40}},T2:{cuisine:{min:10,max:50},"salle-de-bain":{min:5,max:40},wc:{min:5,max:30},"autre-sdb":{min:0,max:40}},T3:{cuisine:{min:10,max:45},"salle-de-bain":{min:5,max:35},wc:{min:5,max:30},"autre-sdb":{min:5,max:35}},T4:{cuisine:{min:15,max:45},"salle-de-bain":{min:5,max:35},wc:{min:5,max:30},"autre-sdb":{min:5,max:35}},"T5+":{cuisine:{min:15,max:50},"salle-de-bain":{min:10,max:40},wc:{min:5,max:30},"autre-sdb":{min:10,max:40}}},"double-flux":{T1:{cuisine:{min:45,max:120},"salle-de-bain":{min:15,max:30},wc:{min:15,max:30},"autre-sdb":{min:0,max:30}},T2:{cuisine:{min:45,max:120},"salle-de-bain":{min:15,max:30},wc:{min:15,max:30},"autre-sdb":{min:0,max:30}},T3:{cuisine:{min:45,max:135},"salle-de-bain":{min:15,max:30},wc:{min:15,max:30},"autre-sdb":{min:15,max:30}},T4:{cuisine:{min:45,max:135},"salle-de-bain":{min:30,max:30},wc:{min:15,max:30},"autre-sdb":{min:15,max:30}},"T5+":{cuisine:{min:45,max:135},"salle-de-bain":{min:30,max:30},wc:{min:15,max:30},"autre-sdb":{min:15,max:30}}},"vmc-gaz":{T1:{cuisine:{min:45,max:75,"grand-debit":90},"salle-de-bain":{min:15,max:15,"grand-debit":15},wc:{min:15,max:15},"autre-sdb":{min:0,max:15}},T2:{cuisine:{min:45,max:90,"grand-debit":105},"salle-de-bain":{min:15,max:15,"grand-debit":30},wc:{min:15,max:15},"autre-sdb":{min:0,max:15}},T3:{cuisine:{min:45,max:105,"grand-debit":120},"salle-de-bain":{min:15,max:30,"grand-debit":45},wc:{min:15,max:15},"autre-sdb":{min:15,max:15}},T4:{cuisine:{min:45,max:120,"grand-debit":135},"salle-de-bain":{min:15,max:30,"grand-debit":45},wc:{min:30,max:30},"autre-sdb":{min:15,max:15}},"T5+":{cuisine:{min:45,max:135,"grand-debit":135},"salle-de-bain":{min:15,max:30,"grand-debit":45},wc:{min:30,max:30},"autre-sdb":{min:15,max:15}}}},n={m3h_to_ms:function(e,n){return e/3600/(Math.PI*Math.pow(n/1e3/2,2))},ms_to_m3h:function(e,n){return e*(Math.PI*Math.pow(n/1e3/2,2))*3600},pa_to_mmce:function(e){return e/9.81},mmce_to_pa:function(e){return 9.81*e}};window.vmcContent["verification-debit"]={title:"Vérification des Débits VMC",content:'\n        <div class="section-container">\n          <h2 class="section-title">Assistant de Vérification des Débits VMC</h2>\n          <p>Cet outil vous permet de vérifier si les débits mesurés sur une installation VMC sont conformes aux exigences réglementaires selon le type de logement et le système VMC.</p>\n          \n          <div class="calculator-container">\n            <div class="form-group">\n              <label for="typeLogement">Type de logement :</label>\n              <select id="typeLogement" class="form-control auto-update">\n                <option value="T1">T1</option>\n                <option value="T2">T2</option>\n                <option value="T3" selected>T3</option>\n                <option value="T4">T4</option>\n                <option value="T5+">T5 et plus</option>\n              </select>\n            </div>\n            \n            <div class="form-group">\n              <label for="typeVMC">Type de VMC :</label>\n              <select id="typeVMC" class="form-control auto-update">\n                <option value="simple-flux">VMC Simple Flux Autoréglable</option>\n                <option value="hygro-a">VMC Hygroréglable Type A</option>\n                <option value="hygro-b">VMC Hygroréglable Type B</option>\n                <option value="double-flux">VMC Double Flux</option>\n                <option value="vmc-gaz">VMC Gaz</option>\n              </select>\n            </div>\n            \n            <div class="form-group">\n              <label>Unité de mesure :</label>\n              <div class="radio-group">\n                <label><input type="radio" name="unite" value="m3h" checked class="auto-update"> m³/h</label>\n                <label><input type="radio" name="unite" value="ms" class="auto-update"> m/s</label>\n                <label><input type="radio" name="unite" value="pa" class="auto-update"> Pa</label>\n                <label><input type="radio" name="unite" value="mmce" class="auto-update"> mm CE</label>\n              </div>\n            </div>\n            \n            <div id="diametre-container" class="form-group hidden">\n              <label for="diametre">Diamètre du conduit (mm) :</label>\n              <input type="number" id="diametre" class="form-control auto-update" value="125">\n            </div>\n            \n            <h3>Mesures des débits</h3>\n            <div id="mesures-container">\n              \x3c!-- Sera rempli dynamiquement --\x3e\n            </div>\n            \n            <button id="btnAjouterPiece" class="btn btn-secondary">+ Ajouter une pièce</button>\n            \n            <div id="resultats" class="results-container"></div>\n          </div>\n          \n          <div class="reference-table">\n            <h3>Tableau de référence des débits réglementaires</h3>\n            <div id="reference-table-container">\n              \x3c!-- Sera rempli dynamiquement --\x3e\n            </div>\n          </div>\n          \n          \x3c!-- Intégration du module fenêtres --\x3e\n          <div class="windows-vmc-integration">\n            <h3>Entrées d\'Air des Fenêtres</h3>\n            <p class="sync-info"><strong>Synchronisation automatique :</strong> Les entrées d\'air sont automatiquement adaptées au type de logement sélectionné.</p>\n            \n            <div class="windows-container">\n              \x3c!-- Les entrées d\'air seront ajoutées automatiquement --\x3e\n            </div>\n            \n            <div class="air-inlet-actions">\n              <button id="btnAjouterFenetre" class="btn btn-secondary">+ Ajouter une entrée d\'air supplémentaire</button>\n            </div>\n          </div>\n          \n          <div class="info-block">\n            <h3>Conversion entre unités</h3>\n            <div class="converter-container">\n              <div class="form-group">\n                <label for="valueToConvert">Valeur à convertir :</label>\n                <input type="number" id="valueToConvert" class="form-control">\n              </div>\n              <div class="form-group">\n                <label for="fromUnit">De :</label>\n                <select id="fromUnit" class="form-control">\n                  <option value="m3h">m³/h</option>\n                  <option value="ms">m/s</option>\n                  <option value="pa">Pa</option>\n                  <option value="mmce">mm CE</option>\n                </select>\n              </div>\n              <div class="form-group">\n                <label for="toUnit">Vers :</label>\n                <select id="toUnit" class="form-control">\n                  <option value="m3h">m³/h</option>\n                  <option value="ms">m/s</option>\n                  <option value="pa">Pa</option>\n                  <option value="mmce">mm CE</option>\n                </select>\n              </div>\n              <div class="form-group" id="diametre-conversion-container">\n                <label for="diametreConversion">Diamètre (mm) :</label>\n                <input type="number" id="diametreConversion" class="form-control" value="125">\n              </div>\n              <button id="btnConvert" class="btn btn-secondary">Convertir</button>\n              <div id="conversionResult" class="conversion-result"></div>\n            </div>\n          </div>\n        </div>\n      '},console.log("Module de vérification des débits chargé avec succès"),document.addEventListener("contentLoaded",function(e){"verification-debit"===e.detail.section&&(console.log("Initialisation de l'outil de vérification des débits"),setTimeout(function(){o()},50))});const t=setInterval(()=>{document.querySelector(".calculator-container")&&(clearInterval(t),console.log("Container de calculatrice trouvé, initialisation..."),o())},100);function o(){const e=document.getElementById("typeLogement"),t=document.getElementById("typeVMC"),o=document.getElementsByName("unite"),l=(document.getElementById("diametre"),document.getElementById("mesures-container")),c=document.getElementById("btnAjouterPiece"),m=document.getElementById("resultats"),u=(document.getElementById("reference-table-container"),document.getElementById("diametre-container"));if(!(e&&t&&l&&m))return void console.error("Les éléments du DOM ne sont pas encore disponibles");console.log("Initialisation de l'interface de vérification des débits...");const p=document.getElementById("valueToConvert"),v=document.getElementById("fromUnit"),b=document.getElementById("toUnit"),f=document.getElementById("diametreConversion"),h=document.getElementById("btnConvert"),g=document.getElementById("conversionResult");document.getElementById("diametre-conversion-container");if(i(),l.innerHTML="",r(),e.addEventListener("change",function(){r(),i(),s()}),document.addEventListener("change",function(e){(e.target.classList.contains("auto-update")||e.target.classList.contains("debit-mesure")||e.target.classList.contains("piece-type"))&&s()}),document.addEventListener("input",function(e){e.target.classList.contains("debit-mesure")&&s()}),t&&t.addEventListener("change",function(){i(),s()}),c&&c.addEventListener("click",()=>{r(),setTimeout(s,50)}),h&&h.addEventListener("click",()=>{if(!(p&&v&&b&&g))return;const e=parseFloat(p.value);if(isNaN(e))return void(g.innerHTML='<span class="error">Veuillez entrer un nombre valide</span>');const t=v.value,o=b.value;let i,a=d(o);if("m3h"===t&&"ms"===o){const t=parseFloat(f.value);if(isNaN(t)||t<=0)return void(g.innerHTML='<span class="error">Diamètre invalide</span>');i=n.m3h_to_ms(e,t)}else if("ms"===t&&"m3h"===o){const t=parseFloat(f.value);if(isNaN(t)||t<=0)return void(g.innerHTML='<span class="error">Diamètre invalide</span>');i=n.ms_to_m3h(e,t)}else if("pa"===t&&"mmce"===o)i=n.pa_to_mmce(e);else if("mmce"===t&&"pa"===o)i=n.mmce_to_pa(e);else{if(t!==o)return void(g.innerHTML='<span class="error">Conversion non supportée</span>');i=e}g.innerHTML=`<strong>Résultat:</strong> ${e} ${d(t)} = ${i.toFixed(2)} ${a}`}),o)for(const e of o)e.addEventListener("change",function(){"ms"===this.value?u.classList.remove("hidden"):u.classList.add("hidden"),window.innerWidth<=768&&setTimeout(()=>{const e=document.getElementById("reference-table-container");e&&e.scrollIntoView({behavior:"smooth"})},300)});v&&b&&(v.addEventListener("change",a),b.addEventListener("change",a),a())}function i(){const n=document.getElementById("reference-table-container"),t=document.getElementById("typeLogement"),o=document.getElementById("typeVMC");if(!n||!t||!o)return void console.error("Éléments manquants pour mettre à jour le tableau de référence");const i=t.value,a=o.value;if(!e[a]||!e[a][i])return void console.error(`Données de débit non trouvées pour VMC ${a} et logement ${i}`);const r=e[a][i];let d=`\n        <table class="technical-table">\n          <tr>\n            <th>Pièce</th>\n            <th>Débit minimal (m³/h)</th>\n            <th>Débit maximal (m³/h)</th>\n            ${"vmc-gaz"===a?"<th>Grand débit (m³/h)</th>":""}\n          </tr>\n      `;for(const e in r)d+=`\n          <tr>\n            <td>${l(e)}</td>\n            <td>${r[e].min}</td>\n            <td>${r[e].max}</td>\n            ${"vmc-gaz"===a&&r[e]["grand-debit"]?`<td>${r[e]["grand-debit"]}</td>`:"vmc-gaz"===a?"<td>-</td>":""}\n          </tr>\n        `;d+="</table>",n.innerHTML=d,console.log(`Tableau de référence mis à jour pour ${a} et ${i}`),s()}function a(){const e=document.getElementById("fromUnit"),n=document.getElementById("toUnit"),t=document.getElementById("diametre-conversion-container");if(!e||!n||!t)return;const o=e.value,i=n.value;t.style.display="m3h"===o&&"ms"===i||"ms"===o&&"m3h"===i?"block":"none";const a=document.getElementById("conversionResult");a&&(a.innerHTML="")}function r(e=null){const n=document.getElementById("typeLogement"),t=n?n.value:"T3",o=document.getElementById("mesures-container");console.log(`Ajout des champs de mesure pour le type de logement: ${t}`),e||(o.innerHTML="");let i=[];switch(t){case"T1":case"T2":default:i=["cuisine","salle-de-bain","wc"];break;case"T3":case"T4":case"T5+":i=["cuisine","salle-de-bain","wc","autre-sdb"]}e&&(i=[e]),console.log(`Pièces à ajouter: ${i.join(", ")}`),i.forEach(e=>{const n=document.createElement("div");n.className="mesure-item";const t=document.createElement("div");t.className="mesure-row";const i=document.createElement("div");i.className="form-group";const a=document.createElement("label");a.textContent="Type de pièce:";const r=document.createElement("select");r.className="form-control piece-type auto-update";[{value:"cuisine",text:"Cuisine"},{value:"salle-de-bain",text:"Salle de bain principale"},{value:"wc",text:"WC"},{value:"autre-sdb",text:"Autre salle d'eau"}].forEach(n=>{const t=document.createElement("option");t.value=n.value,t.textContent=n.text,e===n.value&&(t.selected=!0),r.appendChild(t)}),i.appendChild(a),i.appendChild(r);const l=document.createElement("div");l.className="form-group";const d=document.createElement("label");d.textContent="Débit mesuré:";const c=document.createElement("input");c.type="number",c.className="form-control debit-mesure",c.min="0",c.step="any",l.appendChild(d),l.appendChild(c);const m=document.createElement("button");m.className="btn-remove",m.innerHTML="&times;",m.style.minHeight="44px",m.style.minWidth="44px",m.addEventListener("click",function(){o.removeChild(n),s()});const u=document.createElement("div");u.className="mesure-status",t.appendChild(i),t.appendChild(l),t.appendChild(m),n.appendChild(t),n.appendChild(u),o.appendChild(n)})}function s(){const t=document.getElementById("resultats");if(!t)return;const o=document.getElementById("typeLogement"),i=o?o.value:"T3",a=document.getElementById("typeVMC"),r=a?a.value:"simple-flux",s=document.querySelector('input[name="unite"]:checked').value,d=document.getElementById("diametre"),u=d?parseFloat(d.value):125,p=e[r][i],v=[];document.querySelectorAll(".mesure-item").forEach(e=>{const t=e.querySelector(".piece-type").value,o=e.querySelector(".debit-mesure");let i=parseFloat(o.value)||0;if("ms"===s)i=n.ms_to_m3h(i,u);else if("pa"===s)i=10*Math.sqrt(i);else if("mmce"===s){const e=n.mmce_to_pa(i);i=10*Math.sqrt(e)}const a=p[t];if(!a)return void console.error(`Référence non trouvée pour pièce ${t}`);const r=a.min,l=a.max;let d="success";(i<r||i>l)&&(d="error"),v.push({type:t,valeur:i,min:r,max:l,etat:d});const m=e.querySelector(".mesure-status");if(m)if(0===i||isNaN(i))m.innerHTML="";else{const e=c(d,i,r,l),n="success"===d?"success":"error";m.innerHTML=`<span class="${n}">${e}</span>`}});let b=v.filter(e=>"success"===e.etat).length,f=v.length>0?Math.round(b/v.length*100):0,h=v.filter(e=>"error"===e.etat&&e.valeur<e.min).length,g=v.filter(e=>"error"===e.etat&&e.valeur>e.max).length,y="success";f<70?y="error":f<100&&(y="warning");let x='\n        <table class="results-table">\n          <tr>\n            <th>Pièce</th>\n            <th>Débit mesuré (m³/h)</th>\n            <th>Débit min (m³/h)</th>\n            <th>Débit max (m³/h)</th>\n            <th>Etat</th>\n          </tr>\n      ';if(v.forEach(e=>{0===e.valeur||isNaN(e.valeur)||(x+=`\n          <tr class="${e.etat}">\n            <td>${l(e.type)}</td>\n            <td>${e.valeur.toFixed(1)}</td>\n            <td>${e.min}</td>\n            <td>${e.max}</td>\n            <td>${c(e.etat,e.valeur,e.min,e.max)}</td>\n          </tr>\n        `)}),x+="</table>",v.length>0&&v.filter(e=>e.valeur>0).length>0){const e=m(f,h,g);x+=`\n          <div class="results-summary ${y}">\n            <h3>Conformité globale: ${f}%</h3>\n            <p><strong>Diagnostic:</strong> ${e}</p>\n          </div>\n        `}t.innerHTML=x}function l(e){switch(e){case"cuisine":return"Cuisine";case"salle-de-bain":return"Salle de bain principale";case"wc":return"WC";case"autre-sdb":return"Autre salle d'eau";default:return e}}function d(e){switch(e){case"m3h":return"m³/h";case"ms":return"m/s";case"pa":return"Pa";case"mmce":return"mm CE";default:return e}}function c(e,n,t,o){return"error"===e?n<t?"DÉBIT INSUFFISANT":n>o?"DÉBIT TROP ÉLEVÉ":"ERREUR":"CONFORME"}function m(e,n,t){return 100===e?"Installation conforme":e>=80?"Installation globalement conforme avec quelques ajustements nécessaires":e>=50?n>t?"Débit global insuffisant - Vérifier le caisson VMC":"Déséquilibre dans la distribution des débits - Réglage des bouches nécessaire":n>t?"Débit très insuffisant - Vérifier le dimensionnement de l'installation":"Installation non conforme nécessitant une révision complète"}function u(){const e=document.querySelector(".windows-container");if(!e)return;const n={salon:{standard:30,hygro:"6-45"},chambre:{standard:15,hygro:"6-22"},sejour:{standard:30,hygro:"6-45"},"autre-piece":{standard:15,hygro:"6-22"}};function t(e){const t=e.querySelector(".window-room-type").value,o=e.querySelector(".air-inlet-type").value,i=e.querySelector(".air-inlet-module");if(i.innerHTML="","standard"===o){const e=n[t]?.standard||15;[15,22,30,45].forEach(n=>{const t=document.createElement("option");t.value=n,t.textContent=`${n} m³/h`,t.selected=n===e,i.appendChild(t)})}else{const e=n[t]?.hygro||"6-22",o=document.createElement("option");o.value=e,o.textContent=`${e} m³/h (hygro)`,i.appendChild(o)}const a=e.querySelector(".air-flow-value");a&&(a.textContent=i.value+" m³/h")}function o(e){const n=e.querySelector(".window-state").value,t=e.querySelector(".air-inlet-module").value,o=e.querySelector(".air-flow-value"),a=e.querySelector(".progress-fill"),r=e.querySelector(".efficiency-percent");let s=1;switch(n){case"neuf":s=1;break;case"bon":s=.9;break;case"moyen":s=.7;break;case"mauvais":s=.5}let l=0;if(t.includes("-")){const[e,n]=t.split("-").map(Number);l=(e+n)/2}else l=parseInt(t);const d=l*s;t.includes("-")?o.textContent=`${Math.round(d)} m³/h (moyenne)`:o.textContent=`${Math.round(d)} m³/h`;const c=Math.round(100*s);a.style.width=`${c}%`,r.textContent=`${c}%`,a.style.backgroundColor=s<.6?"#dc3545":s<.8?"#ffc107":"#28a745",i()}function i(){const e=document.querySelectorAll(".window-item");let n=0,t=0,o=0;e.forEach(e=>{try{const i=e.querySelector(".air-inlet-module"),a=e.querySelector(".window-state");if(!i||!a)return void console.warn("Élément manquant dans .window-item",e);const r=i.value,s=a.value;let l=1;switch(s){case"neuf":l=1;break;case"bon":l=.9;break;case"moyen":l=.7;break;case"mauvais":l=.5}if(r.includes("-")){const[e,n]=r.split("-").map(Number);t+=e*l,o+=n*l}else n+=parseInt(r)*l}catch(e){console.error("Erreur lors du calcul du débit:",e)}});const i=document.querySelector(".air-inlets-summary")||a();i.innerHTML=t>0||o>0?`\n            <h4>Bilan entrées d'air:</h4>\n            <table class="air-inlets-table">\n              <tr>\n                <td>Entrées autoréglables:</td>\n                <td>${Math.round(n)} m³/h</td>\n              </tr>\n              <tr>\n                <td>Entrées hygroréglables:</td>\n                <td>${Math.round(t)} à ${Math.round(o)} m³/h</td>\n              </tr>\n              <tr class="total-row">\n                <td>Débit total estimé:</td>\n                <td>${Math.round(n+t)} à ${Math.round(n+o)} m³/h</td>\n              </tr>\n            </table>\n            <div class="compatibilite-vmc">Ce débit doit correspondre à la somme des débits d'extraction de votre VMC.</div>\n          `:`\n            <h4>Bilan entrées d'air:</h4>\n            <table class="air-inlets-table">\n              <tr>\n                <td>Entrées autoréglables:</td>\n                <td>${Math.round(n)} m³/h</td>\n              </tr>\n              <tr class="total-row">\n                <td>Débit total:</td>\n                <td>${Math.round(n)} m³/h</td>\n              </tr>\n            </table>\n            <div class="compatibilite-vmc">Ce débit doit correspondre à la somme des débits d'extraction de votre VMC.</div>\n          `,r(n+(o>0?t:0))}function a(){const e=document.createElement("div");e.className="air-inlets-summary";const n=document.querySelector(".windows-vmc-integration");return n&&n.appendChild(e),e}function r(e){const n=document.getElementById("typeLogement")?.value||"T3";document.getElementById("typeVMC");let t=0;if(document.querySelectorAll(".mesure-item").forEach(e=>{const n=e.querySelector(".debit-mesure");n&&!isNaN(n.value)&&""!==n.value.trim()&&(t+=parseFloat(n.value))}),0===t)switch(n){case"T1":t=75;break;case"T2":t=90;break;case"T3":default:t=105;break;case"T4":t=120;break;case"T5+":t=135}const o=document.querySelector(".compatibilite-vmc");if(!o)return;const i=e-t,a=Math.abs(i)/t*100;o.innerHTML=a<=10?`<div class="status-indicator good"></div><strong>Équilibre correct :</strong> Le débit d'entrée d'air (${Math.round(e)} m³/h) est bien équilibré avec le débit d'extraction (${Math.round(t)} m³/h).`:a<=20?`<div class="status-indicator warning"></div><strong>Équilibre acceptable :</strong> Le débit d'entrée d'air (${Math.round(e)} m³/h) diffère de ${Math.round(a)}% du débit d'extraction (${Math.round(t)} m³/h).`:i>0?`<div class="status-indicator bad"></div><strong>Déséquilibre :</strong> Le débit d'entrée d'air (${Math.round(e)} m³/h) est trop important par rapport au débit d'extraction (${Math.round(t)} m³/h). Cela peut réduire l'efficacité de la VMC.`:`<div class="status-indicator bad"></div><strong>Déséquilibre :</strong> Le débit d'entrée d'air (${Math.round(e)} m³/h) est insuffisant par rapport au débit d'extraction (${Math.round(t)} m³/h). Risque de dépression et difficultés d'ouverture des portes.`}function s(){const n=document.createElement("div");n.className="window-item",n.innerHTML='\n          <div class="window-row">\n            <div class="form-group">\n              <label>Type de pièce :</label>\n              <select class="form-control window-room-type">\n                <option value="salon">Salon</option>\n                <option value="chambre">Chambre</option>\n                <option value="sejour">Séjour</option>\n                <option value="autre-piece">Autre pièce</option>\n              </select>\n            </div>\n            <div class="form-group">\n              <label>Type d\'entrée d\'air :</label>\n              <select class="form-control air-inlet-type">\n                <option value="standard">Autoréglable</option>\n                <option value="hygro">Hygroréglable</option>\n              </select>\n            </div>\n            <div class="form-group">\n              <label>Module entrée d\'air :</label>\n              <select class="form-control air-inlet-module">\n                <option value="15">15 m³/h</option>\n                <option value="22">22 m³/h</option>\n                <option value="30" selected>30 m³/h</option>\n                <option value="45">45 m³/h</option>\n              </select>\n            </div>\n            <div class="form-group">\n              <label>État :</label>\n              <select class="form-control window-state">\n                <option value="neuf">Neuf</option>\n                <option value="bon">Bon</option>\n                <option value="moyen">Moyen</option>\n                <option value="mauvais">Mauvais</option>\n              </select>\n            </div>\n            <button class="btn-remove window-remove">&times;</button>\n          </div>\n          <div class="window-air-quality">\n            <div class="air-efficiency">\n              <label>Efficacité de l\'entrée d\'air :</label>\n              <div class="progress-bar">\n                <div class="progress-fill" style="width: 100%"></div>\n              </div>\n              <span class="efficiency-percent">100%</span>\n            </div>\n            <p class="window-air-flow"><strong>Débit effectif : </strong><span class="air-flow-value">30 m³/h</span></p>\n          </div>\n        ';const a=n.querySelector(".window-room-type"),r=n.querySelector(".air-inlet-type"),s=n.querySelector(".air-inlet-module"),l=n.querySelector(".window-state");a.addEventListener("change",function(){t(n),o(n)}),r.addEventListener("change",function(){t(n),o(n)}),s.addEventListener("change",function(){o(n)}),l.addEventListener("change",function(){o(n)}),n.querySelector(".window-remove").addEventListener("click",()=>{e.removeChild(n),i()}),e.appendChild(n),t(n),o(n),i()}function l(){const n=document.getElementById("typeLogement").value,a={T1:[{room:"sejour",type:"standard",module:"30"}],T2:[{room:"sejour",type:"standard",module:"30"},{room:"chambre",type:"standard",module:"15"}],T3:[{room:"sejour",type:"standard",module:"30"},{room:"chambre",type:"standard",module:"15"},{room:"chambre",type:"standard",module:"15"}],T4:[{room:"sejour",type:"standard",module:"30"},{room:"chambre",type:"standard",module:"15"},{room:"chambre",type:"standard",module:"15"},{room:"chambre",type:"standard",module:"15"}],"T5+":[{room:"sejour",type:"standard",module:"45"},{room:"chambre",type:"standard",module:"15"},{room:"chambre",type:"standard",module:"15"},{room:"chambre",type:"standard",module:"15"},{room:"chambre",type:"standard",module:"15"}]},r=a[n]||a.T3;for(;e.firstChild;)e.removeChild(e.firstChild);r.forEach(n=>{const i=d(n.room,n.type,n.module);e.appendChild(i),t(i),o(i)}),i(),c(n)}function d(n,a,r){const s=document.createElement("div");s.className="window-item",s.innerHTML=`\n          <div class="window-row">\n            <div class="form-group">\n              <label>Type de pièce :</label>\n              <select class="form-control window-room-type">\n                <option value="salon"${"salon"===n?" selected":""}>Salon</option>\n                <option value="sejour"${"sejour"===n?" selected":""}>Séjour</option>\n                <option value="chambre"${"chambre"===n?" selected":""}>Chambre</option>\n                <option value="autre-piece"${"autre-piece"===n?" selected":""}>Autre pièce</option>\n              </select>\n            </div>\n            <div class="form-group">\n              <label>Type d'entrée d'air :</label>\n              <select class="form-control air-inlet-type">\n                <option value="standard"${"standard"===a?" selected":""}>Autoréglable</option>\n                <option value="hygro"${"hygro"===a?" selected":""}>Hygroréglable</option>\n              </select>\n            </div>\n            <div class="form-group">\n              <label>Module entrée d'air :</label>\n              <select class="form-control air-inlet-module">\n                <option value="15"${"15"===r?" selected":""}>15 m³/h</option>\n                <option value="22"${"22"===r?" selected":""}>22 m³/h</option>\n                <option value="30"${"30"===r?" selected":""}>30 m³/h</option>\n                <option value="45"${"45"===r?" selected":""}>45 m³/h</option>\n              </select>\n            </div>\n            <div class="form-group">\n              <label>État :</label>\n              <select class="form-control window-state">\n                <option value="neuf">Neuf</option>\n                <option value="bon" selected>Bon</option>\n                <option value="moyen">Moyen</option>\n                <option value="mauvais">Mauvais</option>\n              </select>\n            </div>\n            <button class="btn-remove window-remove">&times;</button>\n          </div>\n          <div class="window-air-quality">\n            <div class="air-efficiency">\n              <label>Efficacité de l'entrée d'air :</label>\n              <div class="progress-bar">\n                <div class="progress-fill" style="width: 90%"></div>\n              </div>\n              <span class="efficiency-percent">90%</span>\n            </div>\n            <p class="window-air-flow"><strong>Débit effectif : </strong><span class="air-flow-value">${r} m³/h</span></p>\n          </div>\n        `;const l=s.querySelector(".window-room-type"),d=s.querySelector(".air-inlet-type"),c=s.querySelector(".air-inlet-module"),m=s.querySelector(".window-state");return l.addEventListener("change",function(){t(s),o(s)}),d.addEventListener("change",function(){t(s),o(s)}),c.addEventListener("change",function(){o(s)}),m.addEventListener("change",function(){o(s)}),s.querySelector(".window-remove").addEventListener("click",()=>{e.removeChild(s),i()}),s}function c(e){const n=document.querySelector(".config-message");n&&n.remove();const t=document.createElement("div");t.className="config-message info-message",t.innerHTML=`<strong>Configuration ${e}</strong> : Entrées d'air adaptées automatiquement au logement de type ${e}.`;const o=document.querySelector(".windows-vmc-integration");o&&o.insertBefore(t,o.querySelector(".windows-container")),setTimeout(()=>{t.style.opacity="0",t.style.transition="opacity 1s",setTimeout(()=>t.remove(),1e3)},5e3)}const m=document.getElementById("btnAjouterFenetre");m&&(m.addEventListener("click",s),setTimeout(()=>{0===e.children.length&&s()},300));const u=document.getElementById("typeLogement");if(u){const e=document.querySelector(".sync-info");e&&(e.innerHTML="<strong>Synchronisation automatique :</strong> Les entrées d'air sont automatiquement adaptées au type de logement sélectionné."),setTimeout(l,500),u.addEventListener("change",function(){setTimeout(l,100)})}}function p(){const e=document.createElement("div");e.className="air-inlets-guide",e.innerHTML="\n        <h4>Guide d'utilisation</h4>\n        <p>Pour un équilibre correct de votre système VMC :</p>\n        <ol>\n          <li>Ajoutez une entrée d'air pour chaque fenêtre des pièces principales (séjour, chambres)</li>\n          <li>Sélectionnez le type de pièce et le module approprié (débit en m³/h)</li>\n          <li>Vérifiez que le débit total des entrées d'air correspond au débit total d'extraction</li>\n        </ol>\n        <div class=\"info-note\">\n          <div class=\"info-icon\">ℹ️</div>\n          <div>\n            <p><strong>Types d'entrées d'air :</strong></p>\n            <ul>\n              <li><strong>Autoréglable</strong> : Débit constant quelle que soit la dépression</li>\n              <li><strong>Hygroréglable</strong> : Débit variable selon l'humidité relative</li>\n            </ul>\n          </div>\n        </div>\n      ";const n=document.querySelector(".windows-vmc-integration");return n&&!document.querySelector(".air-inlets-guide")&&n.insertBefore(e,n.querySelector(".windows-container")),e}console.log("Interface de vérification des débits initialisée avec succès"),document.addEventListener("contentLoaded",function(e){"verification-debit"===e.detail.section&&setTimeout(()=>{u(),p()},500)});const v=setInterval(()=>{document.querySelector(".windows-container")&&(clearInterval(v),u(),p())},1e3)}()):(console.log("Attente de vmcContent..."),setTimeout(e,100))};e()});